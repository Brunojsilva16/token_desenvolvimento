<?php // app/Views/pages/meus_tokens.phtml ?>
<div class="container-fluid">
    <h2 class="mb-4">Meus Tokens Gerados</h2>

    <div class="card shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Token</th>
                            <th>Paciente</th>
                            <th>Profissional</th>
                            <th>Data</th>
                            <th>Status</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php if (empty($tokens)): ?>
                            <tr>
                                <td colspan="6" class="text-center text-muted py-4">
                                    Nenhum token encontrado.
                                </td>
                            </tr>
                        <?php else: ?>
                            <?php foreach ($tokens as $t): ?>
                                <tr>
                                    <!-- AJUSTE AQUI: padding maior (px-3 py-2) para não vazar a borda -->
                                    <td>
                                        <span class="badge bg-primary px-3 py-2 shadow-sm" style="font-size: 0.9rem; letter-spacing: 1px;">
                                            <?= $t['token'] ?>
                                        </span>
                                    </td>
                                    <td><?= htmlspecialchars($t['nome_paciente']) ?></td>
                                    <td><?= htmlspecialchars($t['nome_profissional'] ?? 'N/D') ?></td>
                                    <!-- text-nowrap evita que a data quebre em duas linhas -->
                                    <td class="text-nowrap"><?= date('d/m/Y H:i', strtotime($t['data_registro'])) ?></td>
                                    <td>
                                        <?php if ($t['statuspag'] == 'AGUARDANDO'): ?>
                                            <span class="badge bg-warning text-dark">Aguardando</span>
                                        <?php elseif ($t['statuspag'] == 'ATENDIDO'): ?>
                                            <span class="badge bg-success">Atendido</span>
                                        <?php else: ?>
                                            <span class="badge bg-secondary"><?= $t['statuspag'] ?></span>
                                        <?php endif; ?>
                                    </td>
                                    <td>
                                        <a href="<?= URL_BASE ?>/token/imprimir?id=<?= $t['id'] ?>" target="_blank" class="btn btn-sm btn-outline-info" title="Imprimir">
                                            <i class="fas fa-print"></i>
                                        </a>
                                    </td>
                                </tr>
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>